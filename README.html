<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <meta name="author" content="Shaun D. Jackman, Joerg Bohlmann, Inanc Birol" />
  <title>UniqTag: Content-derived unique and stable identifiers for gene annotation</title>
  <style type="text/css">code{white-space: pre;}</style>
  <script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
</head>
<body>
<div id="header">
<h1 class="title">UniqTag: Content-derived unique and stable identifiers for gene annotation</h1>
<h2 class="author">Shaun D. Jackman, Joerg Bohlmann, Inanc Birol</h2>
</div>
<h1 id="summary">Summary</h1>
<p>UniqTag assigns unique identifiers to gene sequences, or other arbitrary sequences of characters, that are derived from the <em>k</em>-mer composition of the sequence. Unlike serial numbers, these identifiers are stable between different assemblies and annotations of the same data.</p>
<h1 id="availability-and-implementation">Availability and implementation</h1>
<p>The implementation of UniqTag is available at</p>
<p><code>https://github.com/sjackman/uniqtag</code></p>
<p>Supplementary data and code to reproduce it is available at</p>
<p><code>https://github.com/sjackman/uniqtag-paper</code></p>
<h1 id="contact">Contact</h1>
<p>Shaun Jackman &lt;sjackman@bcgsc.ca&gt;</p>
<p>Inanc Birol &lt;ibirol@bcgsc.ca&gt;</p>
<h1 id="introduction">Introduction</h1>
<p>The task of annotating the genes of a genome sequence often follows genome sequence assembly. These annotated genes are assigned unique identifiers by which they can be referenced. Assembly and annotation is often an iterative process, by refining the method or by the addition of more sequencing data. These gene identifiers would ideally be stable from one assembly and annotation to the next. Serial numbers are used for identifiers of genes annotated by software such as MAKER (<a href="http://dx.doi.org/10.1104/pp.113.230144">Campbell, 2014</a>), which, although certainly unique, are not stable between assemblies. A single change in the assembly can result in a total renumbering of the annotated genes.</p>
<p>One solution to stabilize identifiers is to assign them based on the content of the gene sequence. A cryptographic hash function such as SHA (Secure Hash Algorithm) (<a href="http://www.nist.gov/manuscript-publication-search.cfm?pub_id=910977">Dang, 2012</a>) derives a message digest from the sequence, such that two sequences with the same content will have the same message digest, and two sequences that differ will have different message digests. If a cryptographic hash were used to identify a gene, the same gene in two assemblies with identical content would be assigned identical identifiers, but by design a slight change in the sequence, such as a single-character substitution, would result in a completely different digest and unique identifier.</p>
<p>A cryptographic hash function is designed so that small changes in the message, even a single bit change, results in large changes to the message digest: half of the bits of the digest are expected to flip, called the avalanche effect (<a href="http://www.scientificamerican.com/article/cryptography-and-computer-privacy/">Feistel, 1973</a>). Locality-sensitive hashing in contrast aims to assign items that are similar to the same hash bucket. A hash function that, after a small perturbation of the sequence, assigns an identical identifier to the sequence is desirable for identifying the genes of a genome sequence assembly project. One such locality-sensitive hash function, MinHash, was employed in identifying web pages with similar content (<a href="http://dx.doi.org/10.1109/SEQUEN.1997.666900">Broder, 1997</a>). UniqTag implements MinHash, where the set of elements of an item is the <em>k</em>-mer composition of the sequence, the hash function is the identity function and the minimal element is the lexicographically minimal sequence, to assign stable identifiers to genes. These identifiers are intended for systematic identification, unique within an assembly, rather than as a biological name, which is typically assigned based on biological function or homology to orthologous genes.</p>
<h1 id="description">Description</h1>
<p>When iterating over multiple assemblies of the same data, it is rather inconvenient when gene identifiers change from one assembly to the next. UniqTag attempts to address this common challenge. By identifying the gene by a feature of its content rather than an arbitrary serial number, the gene identifier is stable between assemblies.</p>
<p>A UniqTag will change due to a difference in the locus of the UniqTag itself, the creation of a least-frequent <em>k</em>-mer that is lexicographically smaller than the previous UniqTag, or the creation of a <em>k</em>-mer elsewhere resulting in the UniqTag no longer being a least-frequent <em>k</em>-mer. Concatenating two gene models results in a gene whose UniqTag is the minimum of the two previous UniqTags, unless one of the k-mer at the junction of the two sequences is lexicographically smaller. Similarly when a gene model is split in two, one gene is assigned a new UniqTag and the other retains the previous UniqTag, unless the previous UniqTag spanned the junction.</p>
<p>A UniqTag can be generated from the nucleotide sequence of a gene. Using instead the translated amino acid sequence of a protein-coding gene sequence results in a UniqTag that is stable across synonymous changes to the coding sequence as well as to changes in the untranslated regions and introns of the gene. Since the amino acid alphabet is larger than the nucleotide alphabet, fewer characters are required for a <em>k</em>-mer to be likely unique, resulting in an aesthetically pleasing shorter identifier.</p>
<p>Two gene models with identical sequence would be assigned the same UniqTag. It is possible that two genes that have no unique <em>k</em>-mer and similar <em>k</em>-mer composition are assigned the same UniqTag. Genes that have the same UniqTag are distinguished by adding a numerical suffix to the UniqTag.</p>
<h2 id="algorithm">Algorithm</h2>
<p>The UniqTag <span class="math">\(u_k(s, S)\)</span>, a substring of the string <em>s</em> with length <em>k</em> from the set of strings <em>S</em>, is defined as follows.</p>
<p><span class="math">\(\Sigma\)</span> is an alphabet. <span class="math">\(\Sigma^k\)</span> is the set of all strings over <span class="math">\(\Sigma\)</span> of length <em>k</em>. <em>s</em> and <em>t</em> are strings over <span class="math">\(\Sigma\)</span>. <span class="math">\(C(s)\)</span> is the set of all substrings of <em>s</em>. A <em>k</em>-mer of <em>s</em> is a substring of <em>s</em> with length <em>k</em>. <span class="math">\(C_k(s)\)</span> is the set of all <em>k</em>-mers of <em>s</em>.</p>
<p><span class="math">\[
C_k(s) = C(s) \cap \Sigma^k
\]</span></p>
<p><em>S</em> is a set of strings over <span class="math">\(\Sigma\)</span>. <span class="math">\(f(s, S)\)</span> is the frequency of <em>s</em> in <em>S</em>, defined as the number of strings in <em>S</em> that contain <em>s</em> as a substring.</p>
<p><span class="math">\[
f(s, S) = \left\vert \{ t \mid s \in C(t) \wedge t \in S \} \right\vert
\]</span></p>
<p><span class="math">\(\min S\)</span> is the lexicographically minimal string of <em>S</em>. <span class="math">\(u_k(s, S)\)</span> is the UniqTag, the lexicographically minimal <em>k</em>-mer of those <em>k</em>-mers of <em>s</em> that are least frequent in <em>S</em>.</p>
<p><span class="math">\[
u_k(s, S) = \min \mathop{\arg\,\min}\limits_{t \in C_k(s)} f(t, S)
\]</span></p>
<h1 id="results">Results</h1>
<p>UniqTag was used to assign seven-character identifiers to the protein sequences of six builds of the Ensembl human genome (<a href="http://dx.doi.org/10.1093/nar/gkt1196">Flicek, 2014</a>) spanning five years. A seven-character string from the alphabet of the standard 20 amino acids allows for over a billion distinct identifiers. The Ensembl human genome is used for its archive of historical annotations. The overlap of UniqTag identifers between older builds and the current build 75 is shown in TableÂ 1. Comparing two recent builds 70 (Jan 2013) and 75 (Feb 2014), fewer than 1% of the UniqTags changed, and when comparing a much older build 55 (Jul 2009) and the current build 75, still over half the UniqTags are unchanged.</p>
<table>
<caption>The overlap of UniqTag identifers between older builds of the Ensembl human genome and the current build 75.</caption>
<thead>
<tr class="header">
<th align="right">Build A</th>
<th align="right">Build B</th>
<th align="right">Only in A</th>
<th align="right">In both</th>
<th align="right">Only in B</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">55</td>
<td align="right">75</td>
<td align="right">24299</td>
<td align="right">30997</td>
<td align="right">17600</td>
</tr>
<tr class="even">
<td align="right">60</td>
<td align="right">75</td>
<td align="right">9365</td>
<td align="right">34859</td>
<td align="right">13738</td>
</tr>
<tr class="odd">
<td align="right">65</td>
<td align="right">75</td>
<td align="right">1088</td>
<td align="right">45931</td>
<td align="right">2666</td>
</tr>
<tr class="even">
<td align="right">70</td>
<td align="right">75</td>
<td align="right">231</td>
<td align="right">47955</td>
<td align="right">642</td>
</tr>
<tr class="odd">
<td align="right">74</td>
<td align="right">75</td>
<td align="right">0</td>
<td align="right">48597</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<h1 id="acknowledgements" class="unnumbered">Acknowledgements</h1>
<p>The author thanks Nathaniel Street for his enthusiastic feedback, the SMarTForests project and the organizers of the 2014 Conifer Genome Summit that made our conversation possible.</p>
<p><em>Funding</em>: This work was supported by the Natural Sciences and Engineering Research Council of Canada, Genome British Columbia, Genome Alberta, Genome Quebec and Genome Canada.</p>
<h1 id="references" class="unnumbered">References</h1>
<p><a href="http://dx.doi.org/10.1109/SEQUEN.1997.666900">Broder, A. Z. (1997)</a> On the resemblance and containment of documents. <em>Compression and Complexity of Sequences</em>, 1997 Proceedings, 21-29.<br /><a href="http://dx.doi.org/10.1104/pp.113.230144">Campbell, M. S. <em>et al.</em> (2014)</a> MAKER-P: a tool-kit for the rapid creation, management, and quality control of plant genome annotations. <em>Plant Physiology</em>, 164(2), 513-524.<br /><a href="http://www.nist.gov/manuscript-publication-search.cfm?pub_id=910977">Dang, Q. H. (2012)</a> Secure Hash Standard (SHS). <em>NIST FIPS</em>, 180(4), 1-35.<br /><a href="http://www.scientificamerican.com/article/cryptography-and-computer-privacy/">Feistel, H. (1973)</a> Cryptography and Computer Privacy. <em>Scientific American</em>, 228(5).<br /><a href="http://dx.doi.org/10.1093/nar/gkt1196">Flicek, P. <em>et al.</em> (2014)</a> Ensembl 2014. <em>Nucleic Acids Research</em>, 42(D1), D749-D755.</p>
</body>
</html>
