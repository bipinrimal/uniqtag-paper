<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title></title>
  <style type="text/css">code{white-space: pre;}</style>
  <script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
</head>
<body>
<h1 id="uniqtag-assign-unique-reasonably-stable-content-derived-identifiers-to-genes">UniqTag: Assign unique, reasonably stable, content-derived identifiers to genes</h1>
<p>Shaun Jackman, Joerg Bohlmann, İnanç Birol</p>
<h1 id="abstract">Abstract</h1>
<h2 id="summary">Summary</h2>
<p>UniqTag assigns unique identifiers to gene sequences, or even other arbitrary sequences of characters, that are derived from the <em>k</em>-mer composition of the sequence. Unlike serial or accession numbers, these identifiers are reasonably stable between different assemblies and annotations of the same data.</p>
<h2 id="availability-and-implementation">Availability and implementation</h2>
<p>The implementation of UniqTag is available at <code>https://github.com/sjackman/uniqtag</code></p>
<p>Supplementary data and the code used to generate it is available at <code>https://github.com/sjackman/uniqtag-paper</code></p>
<h2 id="contact">Contact</h2>
<p>Shaun Jackman &lt;sjackman@gmail.com&gt;</p>
<h1 id="introduction">Introduction</h1>
<p>Annotating genes, the process of identifying regions of a genome that code for genes, typically follows genome sequence assembly. These annotated genes are assigned unique identifiers by which they can be referenced. Assembly and annotation is often an iterative process, refining the method to produce better assemblies, or by the addition of the new sequencing data. Ideally these gene identifiers would be reasonably stable from one assembly to the next. Genes are typically assigned serial or accession numbers, which, although certainly unique, are not at all stable between assemblies. One small change in the assembly can result in a total renumbering of the annotated genes.</p>
<p>One solution to stabilize identifiers is to assign them based on the content of the gene sequence, rather than its position in the assembly. A cryptographic hash function such as SHA (Secure Hash Algorithm) (<a href="http://www.nist.gov/manuscript-publication-search.cfm?pub_id=910977">Dang, 2012</a>) derives a message digest from the sequence, such that two sequences with the same content will have the same message digest, and any two sequences with different content will have different message digests. When a message digest is used to identify a gene, the same gene in two assemblies with identical content will be assigned identical identifiers, but, by the design of a cryptographic hash function, even a slight change in the sequence, such as a single-character substitution, will result in a completely different digest and identifier.</p>
<p>A cryptography hash function is designed so that small changes in the message, even a single bit change, results in large changes to the message digest: an expected half the bits of the digest flip, called the avalanche effect (<a href="http://www.scientificamerican.com/article/cryptography-and-computer-privacy/">Feistel, 1973</a>). In contrast, locality-sensitive hashing (LSH) aims to assign items that are similar to the same hash bucket. A hash function that, after a small perturbation of the sequence, assigns the same identifier to the sequence is desirable for identifying the genes of a genome sequence assembly project. One such locality-sensitive hash function, MinHash, was employed in identifying web pages with similar content (<a href="http://dx.doi.org/10.1109/SEQUEN.1997.666900">Broder, 1997</a>). UniqTag implements MinHash, where the set of elements is the <em>k</em>-mer composition of the sequence, the hash function is the identity function and the minimal element is defined as the lexicographically minimal element, to assign reasonably stable identifiers to genes. These identifiers are intended for systematic identification, unique within an assembly, rather than as a biological name, which is typically assigned based on biological function or homology to orthologous genes.</p>
<h1 id="algorithm">Algorithm</h1>
<p>The following symbols and terms are defined.</p>
<ul>
<li><em>Σ</em> is an alphabet</li>
<li><em>s</em> and <em>t</em> are strings, a sequence of symbols from the alphabet <em>Σ</em></li>
<li><em>S</em> is a set of strings over <em>Σ</em></li>
<li><span class="math">\(Σ^k\)</span> is the set of all strings over <em>Σ</em> of length <em>k</em></li>
<li><span class="math">\(\min S\)</span> is the lexicographically minimal string of <em>S</em></li>
<li><span class="math">\(C(s)\)</span> is the set of all substrings of <em>s</em></li>
<li>A <em>k</em>-mer of <em>s</em> is a substring of <em>s</em> with length <em>k</em>, also called an <em>n</em>-gram</li>
<li><span class="math">\(C_k(s)\)</span> is the set of all <em>k</em>-mers present in <em>s</em></li>
<li><span class="math">\(f(s, S)\)</span> is the frequency of <em>s</em> in <em>S</em>, defined as the number of strings in <em>S</em> that contain <em>s</em> as a substring</li>
<li><span class="math">\(f_k(s, S)\)</span> is the frequency of the least frequent <em>k</em>-mers of <em>s</em> in <em>S</em></li>
<li><span class="math">\(F_k(s, S)\)</span> is the set of the least frequent <em>k</em>-mers of <em>s</em> in <em>S</em></li>
<li><span class="math">\(u_k(s, S)\)</span> is the UniqTag, the lexicographically minimal <em>k</em>-mer of the <em>k</em>-mers of <em>s</em> that are least frequent in <em>S</em></li>
</ul>
<p>The UniqTag <span class="math">\(u_k(s, S)\)</span> is defined as follows.</p>
<p><span class="math">\[
\begin{aligned}
C_k(s) &amp;= C(s) ∩ Σ^k
\\ f(s, S) &amp;= \left\vert \{ t \mid t ∈ S ∧ s ∈ C(t) \} \right\vert
\\ f_k(s, S) &amp;= \min_{ t ∈ C_k(s) } f(t, S)
\\ F_k(s, S) &amp;= \{ t \mid t ∈ C_k(s) ∧ f(t, S) = f_k(s, S) \}
\\ u_k(s, S) &amp;= \min F_k(s, S)
\end{aligned}
\]</span></p>
<h1 id="discussion">Discussion</h1>
<p>When iterating over multiple assemblies of the same data, it is rather inconvenient for gene identifiers to change completely from one assembly to the next. The gene identifier scheme described here attempts to address this common annoyance. By identifying the gene by its content, using the lexicographically minimal <em>k</em>-mer in the gene, the gene identifier is reasonably stable across assemblies.</p>
<p>A UniqTag will change due to either a difference in the locus of the UniqTag itself, or a difference that results in the creation of a unique <em>k</em>-mer that is lexicographically smaller than the previous UniqTag. Concatenating two gene models results in a gene whose UniqTag is the minimum of the two previous UniqTags, unless by chance one of the k-mer at the junction of the two sequences is lexicographically smaller. Likewise, splitting a gene model into two results in one gene that retains the previous UniqTag and a second gene that is assigned a new UniqTag, unless the previous UniqTag spanned the junction.</p>
<p>A UniqTag can be generated from the nucleotide sequence of a gene. Using instead the translated amino acid sequence of a protein-coding gene sequence results in a UniqTag that is stable across synonymous changes to the coding sequence, as well as to changes to the untranslated regions (UTR) and introns of the gene. Additionally since the amino acid alphabet is larger than the nucleotide alphabet, fewer characters are necessary for a <em>k</em>-mer to likely be unique, resulting in an aesthetically pleasing and shorter gene identifier.</p>
<p>Two gene models that have identical sequence will have the same UniqTag. It is possible that by chance two genes with different sequence that have no unique <em>k</em>-mer and similar <em>k</em>-mer composition are assigned the same UniqTag. This situation is most common for very short sequences. Genes that are assigned the same UniqTag are distinguished by adding a serial numerical suffix to the UniqTag.</p>
<h1 id="acknowledgements">Acknowledgements</h1>
<p>Thanks to Nathaniel Street for his enthusiastic feedback, to the SMarTForests project, its funders and the organizers of the 2014 Conifer Genome Summit that made our conversation possible.</p>
<h1 id="funding">Funding</h1>
<p>This work was supported by the Natural Sciences and Engineering Research Council of Canada, Genome British Columbia, Genome Alberta, Genome Québec and Genome Canada.</p>
<h1 id="references">References</h1>
<ul>
<li><a href="http://dx.doi.org/10.1109/SEQUEN.1997.666900">Broder, A. Z. (1997)</a> On the resemblance and containment of documents. <em>Compression and Complexity of Sequences</em>, 1997 Proceedings, 21-29.</li>
<li><a href="http://www.nist.gov/manuscript-publication-search.cfm?pub_id=910977">Dang, Q. H. (2012)</a> Secure Hash Standard (SHS). <em>NIST FIPS</em>, 180(4), 1-35.</li>
<li><a href="http://www.scientificamerican.com/article/cryptography-and-computer-privacy/">Feistel, H. (1973)</a> Cryptography and Computer Privacy. <em>Scientific American</em>, 228(5).</li>
</ul>
</body>
</html>
